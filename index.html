<html>
<head>
  <title>LiMuT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  <style>
    body {
      font-family: helvetica, arial;
    }
    .widget {
      background: #f8f8f8;
      border: 2px solid #202020;
      border-radius: 6px;
      margin: 4px;
      padding: 4px
    }
    button {
      font-size: 2em;
    }
    span {
      font-weight: bold;
    }
    span.beat-readout {
      font-weight: normal;
      font-family: courier, mono;
    }
    .info {
      width: 100%;
      max-width: 100%;
    }
    pre {
      width: 100%;
      max-width: 100%;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <div class="widget">
    <h1>Global</h1>
    <p>main.amp: <span id="main-amp-readout"></span> <input id="main-amp-slider" type="range" min="0" max="200" oninput="mainAmpChange(parseFloat(this.value)/100)" style="width:80%;" /></p>
    <p>main.reverb: <span id="main-reverb-readout"></span> Scale: <span id="scale-readout"></span></p>
    <p>bpm: <span id="bpm-readout"> : </span> beat: <span class="beat-readout" id="beat-readout"></span> : <span class="beat-readout" id="beat3-readout"></span> <span class="beat-readout" id="beat4-readout"></span> <span class="beat-readout" id="beat16-readout"></span> <span class="beat-readout" id="beat32-readout"></span></p>
  </div>
  <div class="widget">
    <p>
      <button onclick="go()">▶</button>
      <button onclick="stop()">◼</button>
    </p>
    <p>
      <textarea id="code" rows="20" style="width: 100%; max-width: 100%; font-size:1.2em;"></textarea>
    </p>
  </div>
<div class="info">
Examples:
<pre>d1 play x-o-</pre>
<pre>p1 dsaw 0534, add=(0,2,4), dur=4</pre>
<pre>Ba dbass 0, dur=1/4, add=[0:2]r*2, lpf=[3:12]r*100, lpr=8, att=0</pre>
<pre>ARP dsaw 02479742, dur=1/4, lpf=100*[3,30]l6.8, lpr=8, Oct=(3,5), echo=3/8, att=0
Bass dbass -2210, dur=4, Oct=(2,3)
</pre>
<pre>chords = [0,2,-2,3]t8
p1 dbass 0-100, dur=1, chop=[2,2.5,3]t1, add=chords, echo=(1/17,1/23)
k play X., lpf=800
s play ..*.
hh play -., echo=1/4, amp=2
arp ping 04794697, dur=1/4, echo=3/8, add=chords, lpf=[10000,1000]t[24,8]
main dsaw 0, dur=8, add=chords, detune=(0,0.1,0.3), chop=[0,2,3]t32, amp=0.5</pre>
<pre>Perc play lstig, dur=[1,3,2], amp=0.2, echo=1/8
Amb ping 0[21]., dur=4, release=8, detune=[(0,0.3,0.7,1.3),(0,0.5,0.9,1.4)]t4
Bass dbass 0, dur=8, att=2, rel=4, lpf=lpf=100*[3,30]l16</pre>
<pre>Main.reverb = 10
Ba dbass 004[21], dur=4, amp=1.5
Kd play x[.x]x., dur=2
Sn play .o, dur=2</pre>
<pre>bpm = 140
d1 play x.
d2 play .[--]</pre>
<h3>predefined vars</h3>
<p><code>bpm</code> Beats per minute</p>
<p><code>main.amp</code> Main mix amplitude control</p>
<p><code>main.reverb</code> Main reverb amplitude control</p>
<p><code>scale</code> Scale eg minor, major, chromatic, majorpentatonic, lydian etc etc</p>
<h3>Synths</h3>
<p><code>! / stop / none</code> </p>
<p><code>play</code> Play samples. Use letters, symbols and digits 1-4 in the pattern to choose the sample. Note duration defaults to 1/2.</p>
<p><code>drums</code> Basic drum synth; accepts XxOo-= characters in the pattern. Note duration defaults to 1/2.</p>
<p><code>dsaw</code> </p>
<p><code>dbass</code> </p>
<p><code>ping</code> </p>
<p><code>swell</code> </p>
<h3>Pattern syntax</h3>
<p><code>x-o-</code> Sequence of events, each of duration <code>dur</code>, for use with <code>play</code></p>
<p><code>0123</code> Sequence of events, each of duration <code>dur</code>, for use with tonal synths. Numbers are scale degrees</p>
<p><code>0-1-2-3</code> Negative scale degrees allow tones below the synth root pitch</p>
<p><code>x.</code> Use a dot for a rest</p>
<p><code>0_[_1]</code> Use underscore to extend the previous note duration</p>
<p><code>0[123]</code> Square brackets to fit multiple events into one <code>dur</code> (triplet shown)</p>
<h3>params</h3>
<p><code>amp</code> Player amplitude control</p>
<p><code>oct</code> Octave</p>
<p><code>att</code> Attack time in beats</p>
<p><code>decay</code> Decay time in beats</p>
<p><code>sus</code> Sustain time in beats</p>
<p><code>suslevel</code> Sustain amplitude control</p>
<p><code>rel</code> Release time in beats</p>
<p><code>dur</code> Event time in beats</p>
<p><code>delay</code> Event start time offset in beats</p>
<p><code>echo</code> Echo time delay in beats</p>
<p><code>detune</code> Amount of detune in semitones</p>
<p><code>add</code> Amount to add onto event scale degree, in degrees</p>
<p><code>lpf</code> Low pass filter frequency</p>
<p><code>lpr</code> Low pass filter resonance</p>
<p><code>hpf</code> High pass filter frequency</p>
<p><code>hpr</code> High pass filter resonance</p>
<p><code>chop</code> Chop the signal into a number of parts per beat</p>
<p><code>rate</code> Playback rate for 'play' samples</p>
<p><code>sample</code> Sample set choice for 'play' samples</p>
<h3>Param syntax</h3>
<p><code>1</code> Single value</p>
<p><code>(1,2)</code> Multiple values, all played together</p>
<p><code>[1,2]</code> Sequence of values, one per event in the pattern</p>
<p><code>[1,2]t3</code> Timed sequence, each value lasts for 3 beats</p>
<p><code>[1,2]t[12,4]</code> Timed sequence with one timing per value</p>
<p><code>[1,2]l3</code> Timed linear interpolated sequence, each value takes 3 beats to change into the next</p>
<p><code>[1,2]l[14,2]</code> Timed linear interpolated sequence, one timing per value</p>
<p><code>[1,2]s3</code> Timed smooth interpolated sequence, each value takes 3 beats to change into the next, using an 's' shaped eas in/out curve</p>
<p><code>[1,2]s[14,2]</code> Timed 's' interpolated sequence, one timing per value</p>
<p><code>[1,4,7]r</code> Select a different value every time, chosen randomly from the numbers 1, 4 and 7</p>
<p><code>[:9]r</code> Select a different random integer every time, between 0 and 9</p>
<p><code>[0:9]r</code> Select a different random integer every time, between 0 and 9</p>
<p><code>[0.1:9]r</code> Select a different random floating point value every time, between 0.1 and 9</p>
<p><code>+</code> Add values together; eg [2,3]+4 is equivalent to [6,7]</p>
<p><code>-</code> Subtract values; eg [2,3]-1 is equivalent to [1,2]</p>
<p><code>/</code> Divide values; eg 1/2</p>
<p><code>*</code> Multiply values; eg lpf=[1,2,3]*1000</p>
<p><code>%</code> Take remainder; eg (0,4,7,9)%7 is equivalent to (0,4,0,2)</p>
</div>
</body>
<script data-main="main" src="require.js">
/*
x linear time vars
x s time vars
shape param
room/mix params - cheap shared delay based - https://itnext.io/algorithmic-reverb-and-web-audio-api-e1ccec94621a
 - try doing feedback on a short convolver???
piano synth  https://abbernie.github.io/tune/  https://www.npmjs.com/package/@tonejs/piano
console and proper error reporting
better musicality: extending patterns like every/sometimes/offadd/stutter etc
vib
soprano synth - use vib effect - aaah synth: https://github.com/AppGeo/web-audio-examples/blob/master/formant.html
drive param
sliders
pan
hpf
bpf
root
formant
scale
klank synth
slide param
round brackets for chords in patterns
Report the gain reduction from the compressor, maybe even have a longer term feedback based on it?
<> for 'in sequence on each repeat' in patterns and params
^ operator: concat arrays
? when evaluating time var, can it accept a decimal time? Do we pass event time rather than beat time?
operator precedence
? What do nested [] mean in params?
allow dur to be tvar
?extract some of the playing stuff out of pattern.js?
Syntax to make parts of patterns repeat a set number of times?
?? Should param pattern repeat be independent of main pattern repeat? Eg so you can xo, amp=[1,2,3] and it multiplies out
index pattern by beat to improve performance in finding events - same for timeVar evaluation
random timevar gens for patterns: {o-:}
param random can be from a list of values: {0,1,3,4}
fix delay param problems (commented tests in pattern.js)
pattern generators: tri, Dur, walk etc?
Preload samples immediately after parsing
evaluate predefined vars; eg allow bpm=[80,120]
*/
</script>
</html>
