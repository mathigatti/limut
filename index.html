<html>
<head>
  <title>LiMuT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  <style>
    body {
      font-family: helvetica, arial;
      background: #202830;
      color: #d0d0d0;
      text-shadow: #000 0px 0px 1px;
    }
    .fullscreen {
      position:fixed;
      top:0%;
      left:0%;
      width:100%;
      height:100%;
      z-index: -1;
    }
    .widget {
      color: #d0d0d0;
      border: 2px solid #202020;
      border-radius: 6px;
      margin: 4px;
      padding: 4px;
      font-size: 1.1em;
    }
    textarea {
      color: #e0e0e0;
      width: 100%;
      max-width: 100%;
      background: transparent;
      text-shadow: #000 0px 0px 1px;
    }
    textarea#console {
      color: #c0c0c0;
    }
    button {
      background: #808080;
      font-size: 2em;
    }
    span {
      font-weight: bold;
    }
    span.beat-readout {
      font-weight: normal;
      font-family: courier, mono;
    }
    .info {
      width: 100%;
      max-width: 100%;
    }
    pre {
      width: 100%;
      max-width: 100%;
      overflow-x: auto;
    }
    #compressor-readout {
      display: inline-block;
      width: 1em;
      height: 1em;
      background-color: #808080;
    }
    p {
    }
  </style>
</head>
<body>
  <canvas id="canvas" class="fullscreen" style="width:100%; height:100%;"></canvas>
  <div class="widget">
    <h3>Limut</h3>
    <p>
      main.amp: <span id="main-amp-readout"></span>
      <input id="main-amp-slider" type="range" min="0" max="200" oninput="mainAmpChange(parseFloat(this.value)/100)" style="width:80%;" />
    </p>
    <p>
      main.reverb: <span id="main-reverb-readout"></span>
      Compression: <span id="compressor-readout"> </span>
      Scale: <span id="scale-readout"></span>
    </p>
    <p>
      bpm: <span id="bpm-readout"> : </span>
      beat: <span class="beat-readout" id="beat-readout"></span> :
      <span class="beat-readout" id="beat3-readout"></span>
      <span class="beat-readout" id="beat4-readout"></span>
      <span class="beat-readout" id="beat16-readout"></span>
      <span class="beat-readout" id="beat32-readout"></span>
    </p>
  </div>
  <div class="widget">
    <p>
      <button onclick="go()">▶</button>
      <button onclick="stop()">◼</button>
    </p>
    <p>
      <textarea id="code" rows="15"></textarea>
      <textarea id="console" rows="7"></textarea>
    </p>
  </div>
<div class="info">
Examples:
<pre>d1 play x-o-</pre>
<pre>p1 dsaw 0534, add=(0,2,4), dur=4</pre>
<pre>Ba dbass 0, dur=1/4, add=[0:2]r*2, lpf=[3:12]r*100, lpr=8, att=0</pre>
<pre>ARP dsaw 02479742, dur=1/4, lpf=100*[3,30]l6.8, lpr=8, Oct=(3,5), echo=3/8, att=0
Bass dbass -2210, dur=4, Oct=(2,3)
</pre>
<pre>chords = [0,2,-2,3]t8
p1 dbass 0-100, dur=1, chop=[2,2.5,3]t1, add=chords, echo=(1/17,1/23)
k play X., lpf=800
s play ..*.
hh play -., echo=1/4, amp=2
arp ping 04794697, dur=1/4, echo=3/8, add=chords, lpf=[10000,1000]t[24,8]
main dsaw 0, dur=8, add=chords, detune=(0,0.1,0.3), chop=[0,2,3]t32, amp=0.5</pre>
<pre>d play x.h[.x]x[x.]h.
chords=[0,2,4,3]t[16,8,4,4]
be bell 0[.......2], dur=8, add=chords
gl glock 024797.., dur=1/4, add=chords</pre>
<pre>Perc play lstig, dur=[1,3,2], amp=0.2, echo=1/8
Amb ping 0[21]., dur=4, release=8, detune=[(0,0.3,0.7,1.3),(0,0.5,0.9,1.4)]t4
Bass dbass 0, dur=8, att=2, rel=4, lpf=lpf=100*[3,30]l16</pre>
<pre>Prog=[2,5,4,0]t8
Ba piano 0__2, add=prog, amp=4, Oct=2
Ch piano 0, dur=8, Sus=12, add=(prog+(0,2,4))%7, amp=2, Oct=3
Le piano 0_.[.0]2343, amp=3, add=prog, Oct=4</pre>
<pre>scale=minor
Ba dbass 0.4[21], dur=4, amp=1.5, room=1
Kd play x[.x]x., dur=2, room=1
Sn play .o, dur=2, room=1</pre>
<pre>bpm = 140
d1 play (vx)., room=0.3
d2 play .[::], room=0.3
ba dbass 0[.0][_0][_0], att=0, room=0.3</pre>
<h3>predefined vars</h3>
<p><code>bpm</code> Beats per minute</p>
<p><code>main.amp</code> Main mix amplitude control</p>
<p><code>main.reverb</code> Main reverb amplitude control</p>
<p><code>scale</code> Scale eg minor, major, chromatic, majorpentatonic, lydian etc etc</p>
<p><code>drop6.2</code> Predefined time var: equivalent to <code>[1,0]t[6.2]</code>. These are all the predefined drops: drop6.2, drop7.1, drop12.4, drop14.2, drop15.1, drop24.8, drop28.4, drop30.2, drop31.1, drop56.8, drop60.4, drop62.2, drop63.1</p>
<h3>Synths</h3>
<p><code>! / stop / none</code> </p>
<p><code>play</code> Play samples. Use letters, symbols and digits 1-4 in the pattern to choose the sample. Note duration defaults to 1/2.</p>
<p><code>drums</code> Basic drum synth; accepts XxOo-= characters in the pattern. Note duration defaults to 1/2.</p>
<p><code>dsaw</code> Detuned saw pad</p>
<p><code>dbass</code> Detuned saw bass</p>
<p><code>ping</code> Sine ping</p>
<p><code>swell</code> Swell pad</p>
<p><code>bell</code> FM generated bell</p>
<p><code>glock</code> FM generated glockenspiel</p>
<p><code>piano</code> Fairly realistic sampled piano</p>
<p><code>ethereal</code> Ethereal pad</p>
<h3>Pattern syntax</h3>
<p><code>x-o-</code> Sequence of events, each of duration <code>dur</code>, for use with <code>play</code></p>
<p><code>0123</code> Sequence of events, each of duration <code>dur</code>, for use with tonal synths. Numbers are scale degrees</p>
<p><code>0-1-2-3</code> Negative scale degrees allow tones below the synth root pitch</p>
<p><code>x.</code> Use a dot for a rest</p>
<p><code>0_[_1]</code> Use underscore to extend the previous note duration</p>
<p><code>0[123]</code> Square brackets to fit multiple events into one <code>dur</code> (triplet shown)</p>
<p><code>0(135)</code> Round brackets to play multiple events together (i.e. a chord)</p>
<p><code>0&lt;12&gt;</code> Angle brackets to play events in sequence as the pattern repeats. Eg <code>0&lt;12&gt;</code> is exactly equivalent to <code>0102</code></p>
<h3>params</h3>
<p><code>amp</code> Player amplitude control</p>
<p><code>oct</code> Octave</p>
<p><code>att</code> Attack time in beats</p>
<p><code>decay</code> Decay time in beats</p>
<p><code>sus</code> Sustain time in beats</p>
<p><code>suslevel</code> Sustain amplitude control</p>
<p><code>rel</code> Release time in beats</p>
<p><code>dur</code> Event time in beats</p>
<p><code>delay</code> Event start time offset in beats</p>
<p><code>echo</code> Echo time delay in beats</p>
<p><code>detune</code> Amount of detune in semitones</p>
<p><code>add</code> Amount to add onto event scale degree, in degrees</p>
<p><code>lpf</code> Low pass filter frequency</p>
<p><code>lpr</code> Low pass filter resonance</p>
<p><code>hpf</code> High pass filter frequency</p>
<p><code>hpr</code> High pass filter resonance</p>
<p><code>chop</code> Chop the signal into a number of parts per beat</p>
<p><code>rate</code> Playback rate for 'play' samples</p>
<p><code>sample</code> Sample set choice for 'play' samples</p>
<p><code>room</code> reverb room size 0-1</p>
<p><code>drive</code> overdrive level 0-1</p>
<h3>Param syntax</h3>
<p><code>1</code> Single value</p>
<p><code>(1,2)</code> Multiple values, all played together</p>
<p><code>[1,2]</code> Sequence of values, one per event in the pattern</p>
<p><code>[1,2]t3</code> Timed sequence, each value lasts for 3 beats</p>
<p><code>[1,2]t[12,4]</code> Timed sequence with one timing per value</p>
<p><code>[1,2]l3</code> Timed linear interpolated sequence, each value takes 3 beats to change into the next</p>
<p><code>[1,2]l[14,2]</code> Timed linear interpolated sequence, one timing per value</p>
<p><code>[1,2]s3</code> Timed smooth interpolated sequence, each value takes 3 beats to change into the next, using an 's' shaped eas in/out curve</p>
<p><code>[1,2]s[14,2]</code> Timed 's' interpolated sequence, one timing per value</p>
<p><code>[1,4,7]r</code> Select a different value every time, chosen randomly from the numbers 1, 4 and 7</p>
<p><code>[:9]r</code> Select a different random integer every time, between 0 and 9</p>
<p><code>[0:9]r</code> Select a different random integer every time, between 0 and 9</p>
<p><code>[0.1:9]r</code> Select a different random floating point value every time, between 0.1 and 9</p>
<p><code>+</code> Add values together; eg [2,3]+4 is equivalent to [6,7]</p>
<p><code>-</code> Subtract values; eg [2,3]-1 is equivalent to [1,2]</p>
<p><code>/</code> Divide values; eg 1/2</p>
<p><code>*</code> Multiply values; eg lpf=[1,2,3]*1000</p>
<p><code>%</code> Take remainder; eg (0,4,7,9)%7 is equivalent to (0,4,0,2)</p>
<h3>Play samples</h3>
<p>
<code>a</code> Gameboy hihat<br/>
<code>A</code> Gameboy kick drum<br/>
<code>b</code> Noisy beep<br/>
<code>B</code> Short saw<br/>
<code>c</code> Voice/string<br/>
<code>C</code> Choral<br/>
<code>d</code> Woodblock<br/>
<code>D</code> Dirty snare<br/>
<code>e</code> Electronic Cowbell<br/>
<code>E</code> Ringing percussion<br/>
<code>f</code> Pops<br/>
<code>F</code> Trumpet stabs<br/>
<code>g</code> Ominous<br/>
<code>G</code> Ambient stabs<br/>
<code>h</code> Finger snaps<br/>
<code>H</code> Clap<br/>
<code>i</code> Jungle snare<br/>
<code>I</code> Rock snare<br/>
<code>j</code> Whines<br/>
<code>J</code> Ambient stabs<br/>
<code>k</code> Wood shaker<br/>
<code>K</code> Percussive hits<br/>
<code>l</code> Robot noise<br/>
<code>L</code> Noisy percussive hits<br/>
<code>m</code> 808 toms<br/>
<code>M</code> Acoustic toms<br/>
<code>n</code> Noise<br/>
<code>N</code> Gameboy SFX<br/>
<code>o</code> Snare drum<br/>
<code>O</code> Heavy snare<br/>
<code>p</code> Tabla<br/>
<code>P</code> Tabla long<br/>
<code>q</code> Ambient stabs<br/>
<code>Q</code> Electronic stabs<br/>
<code>r</code> Metal<br/>
<code>R</code> Metallic<br/>
<code>s</code> Shaker<br/>
<code>S</code> Tamborine<br/>
<code>t</code> Rimshot<br/>
<code>T</code> Cowbell<br/>
<code>u</code> Soft snare<br/>
<code>U</code> Misc. Fx<br/>
<code>v</code> Soft kick<br/>
<code>V</code> Hard kick<br/>
<code>w</code> Dub hits<br/>
<code>W</code> Distorted<br/>
<code>x</code> Bass drum<br/>
<code>X</code> Heavy kick<br/>
<code>y</code> Percussive hits<br/>
<code>Y</code> High buzz<br/>
<code>z</code> Scratch<br/>
<code>Z</code> Loud stabs<br/>
<code>-</code> Hi hat closed<br/>
<code>|</code> Hangdrum<br/>
<code>=</code> Hi hat open<br/>
<code>/</code> Reverse sounds<br/>
<code>*</code> Clap<br/>
<code>\</code> Lazer<br/>
<code>~</code> Ride cymbal<br/>
<code>%</code> Noise bursts<br/>
<code>^</code> 'Donk'<br/>
<code>$</code> Beatbox<br/>
<code>#</code> Crash<br/>
<code>!</code> Yeah!<br/>
<code>+</code> Clicks<br/>
<code>&amp;</code> Chime<br/>
<code>@</code> Gameboy noise<br/>
<code>:</code> Hi-hats<br/>
<code>1</code> Vocals (One)<br/>
<code>2</code> Vocals (Two)<br/>
<code>3</code> Vocals (Three)<br/>
<code>4</code> Vocals (Four)<br/>
</p>
</div>
</body>
<script data-main="main" src="require.js">
/*
==== audio ====
bpf
try using stepped waveshaper without gain for drive??
room blows up on some browsers above 0.5
drive blows up on some browsers above ??
envelope should come after most effects?
detuned sine pad
root main var
bitcrush param
try using freeverb for main reverb??
vib param
soprano synth - use vib effect - aaah synth: https://github.com/AppGeo/web-audio-examples/blob/master/formant.html
Try a PWM prophet synth (and maybe techno pad too)
strings pad
slide param
formant
pan
scale
Normal bass synth
FM krunchy bass - https://www.youtube.com/watch?v=1XbrTC0NndM
FM ambient synth - https://www.youtube.com/watch?v=_xL3qr-9-ZE
FM wood synth - https://www.youtube.com/watch?v=dXo_493fEpU
==== non-audio ====
<> for 'in sequence on each repeat' in patterns
 all tests / all cases
Pattern can be follow other player, call it's function then add own params on
proper error when set scale to invalid value
Change param random syntax to {}
{} for random in patterns
Solo param - when any player is solod, then any other player thats not solod does not play
fade in/out now (linvar once)
Scale param to set scale for just one player
Support 'penta' and 'pentatonic' as scale names
Preload samples immediately after parsing
rests in params
Beat lag display
<> for 'in sequence on each repeat' in params
GC or LRU or quantisation for echoes and freeverbs
Experiment with reusing audio nodes instead of recreating to defeat glitchiness
Can specify params on separate lines and on grouped players
dur=[3,3,2]\4
timevar once only
live coding controls
 ? Comment in/out?
 ? Solo? Group controls?
 ? Run only cursor/selected code?
 ? Sliders?
better musicality: extending patterns like every/sometimes/offadd/stutter etc
sliders
seeded random: takes repeat length and optional seed
^ operator: concat arrays
? when evaluating time var, can it accept a decimal time? Do we pass event time rather than beat time?
operator precedence
? What do nested [] mean in params?
allow dur to be tvar
?extract some of the playing stuff out of pattern.js?
Syntax to make parts of patterns repeat a set number of times?
?? Should param pattern repeat be independent of main pattern repeat? Eg so you can xo, amp=[1,2,3] and it multiplies out
fix delay param problems (commented tests in pattern.js)
index pattern by beat to improve performance in finding events - same for timeVar evaluation
random timevar gens for patterns: {o-:}
pattern generators: tri, Dur, walk etc?
evaluate predefined vars; eg allow bpm=[80,120]
==== video ====
Use value for kaleidoscope
better text edge visibility
refcator so you can drop shadertoy shader straight in
icky looking edges around textarea boxes etc
docs
more params
particle synth
ability to respond to or follow audio synths
draw frame lag indicator
*/
</script>
</html>
